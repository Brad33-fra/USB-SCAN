import sqlite3
import random

# Connexion √† la base SQLite
conn = sqlite3.connect("vocabulaire.db")
cursor = conn.cursor()

# Cr√©ation de la table si elle n'existe pas
cursor.execute("""
CREATE TABLE IF NOT EXISTS mots (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    mot TEXT UNIQUE,
    traduction TEXT,
    preterit TEXT,
    participe_passe TEXT,
    score INTEGER DEFAULT 0
)
""")
conn.commit()

# Ajouter un mot
def ajouter_mot():
    mot = input("Mot anglais : ")
    traduction = input("Traduction : ")
    preterit = input("Pr√©t√©rit (laisser vide si non-verbe) : ")
    participe_passe = input("Participe pass√© (laisser vide si non-verbe) : ")
    try:
        cursor.execute("INSERT INTO mots (mot, traduction, preterit, participe_passe) VALUES (?, ?, ?, ?)",
                       (mot, traduction, preterit, participe_passe))
        conn.commit()
        print("Mot ajout√© !")
    except sqlite3.IntegrityError:
        print("Ce mot existe d√©j√†.")

# Modifier un mot
def modifier_mot():
    mot = input("Mot √† modifier : ")
    cursor.execute("SELECT * FROM mots WHERE mot = ?", (mot,))
    result = cursor.fetchone()
    if result:
        traduction = input(f"Nouvelle traduction (actuelle: {result[2]}): ") or result[2]
        preterit = input(f"Nouveau pr√©t√©rit (actuel: {result[3]}): ") or result[3]
        participe_passe = input(f"Nouveau participe pass√© (actuel: {result[4]}): ") or result[4]
        cursor.execute("UPDATE mots SET traduction=?, preterit=?, participe_passe=? WHERE mot=?",
                       (traduction, preterit, participe_passe, mot))
        conn.commit()
        print("Mot modifi√© !")
    else:
        print("Mot non trouv√©.")

# Supprimer un mot
def supprimer_mot():
    mot = input("Mot √† supprimer : ")
    cursor.execute("DELETE FROM mots WHERE mot = ?", (mot,))
    conn.commit()
    print("Mot supprim√© !")

# Interroger l'utilisateur
def interroger():
    cursor.execute("SELECT * FROM mots ORDER BY score ASC")
    mots = cursor.fetchall()
    if not mots:
        print("La base est vide. Ajoutez des mots d'abord.")
        return

    mot = random.choice(mots)
    print(f"\nMot √† traduire : {mot[1]}")
    reponse = input("Traduction : ")
    correct = reponse.lower() == mot[2].lower()

    # Si verbe irr√©gulier
    if mot[3] and mot[4]:
        reponse_preterit = input("Pr√©t√©rit : ")
        reponse_participe = input("Participe pass√© : ")
        correct &= (reponse_preterit.lower() == mot[3].lower() and reponse_participe.lower() == mot[4].lower())

    if correct:
        print("Correct ! üéâ")
        cursor.execute("UPDATE mots SET score = score + 1 WHERE id = ?", (mot[0],))
    else:
        print(f"Incorrect. R√©ponses correctes : Traduction='{mot[2]}', Pr√©t√©rit='{mot[3]}', Participe pass√©='{mot[4]}'")
    conn.commit()

# Menu principal
def menu():
    while True:
        print("\n1. Ajouter un mot")
        print("2. Modifier un mot")
        print("3. Supprimer un mot")
        print("4. Interroger")
        print("5. Quitter")
        choix = input("Choix : ")
        if choix == "1":
            ajouter_mot()
        elif choix == "2":
            modifier_mot()
        elif choix == "3":
            supprimer_mot()
        elif choix == "4":
            interroger()
        elif choix == "5":
            break
        else:
            print("Choix invalide")

if __name__ == "__main__":
    menu()
    conn.close()
