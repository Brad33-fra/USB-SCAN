# Importer les outils nÃ©cessaires
import platform      # Pour avoir les infos du PC
import psutil        # Pour avoir RAM, disque, etc.
import socket        # Pour avoir l'adresse IP
import webbrowser    # Pour ouvrir le navigateur
from datetime import datetime  # Pour avoir date et heure

# ===== Ã‰TAPE 1 : DEMANDER LES INFOS Ã€ L'UTILISATEUR =====
print("=== AUDIT DE VOTRE PC ===\n")

nom = input("Votre nom : ")
prenom = input("Votre prÃ©nom : ")
poste = input("NumÃ©ro du poste : ")

# ===== Ã‰TAPE 2 : RÃ‰CUPÃ‰RER LA DATE ET L'HEURE =====
maintenant = datetime.now()
date_audit = maintenant.strftime("%d/%m/%Y")  # Format : 21/11/2025
heure_audit = maintenant.strftime("%H:%M")    # Format : 14:30

# ===== Ã‰TAPE 3 : RÃ‰CUPÃ‰RER LES INFOS DU PC =====

# Le systÃ¨me d'exploitation (Windows, Linux, etc.)
systeme = platform.system() + " " + platform.release()

# Le processeur
processeur = platform.processor()

# Architecture (32 ou 64 bits)
architecture = platform.machine()

# La RAM totale (en Go)
ram_bytes = psutil.virtual_memory().total
ram_go = round(ram_bytes / (1024**3), 2)  # Convertir en Go

# L'espace disque
disque = psutil.disk_usage('/')
disque_total_go = round(disque.total / (1024**3), 2)
disque_libre_go = round(disque.free / (1024**3), 2)

# Le BIOS (pas toujours disponible)
try:
    import wmi
    bios = wmi.WMI().Win32_BIOS()[0].SMBIOSBIOSVersion
except:
    bios = "Non disponible"

# L'adresse IP locale
ip_locale = socket.gethostbyname(socket.gethostname())

# L'adresse MAC
mac = ':'.join(['{:02x}'.format((psutil.net_if_addrs()['Ethernet'][0].address.split('-')[i] if '-' in psutil.net_if_addrs()['Ethernet'][0].address else int(psutil.net_if_addrs()['Ethernet'][0].address.split(':')[i], 16))) for i in range(6)])

# Nombre de ports USB (approximatif)
nb_usb = "Estimation : 4-6 ports"

# Antivirus et Pare-feu (Windows uniquement)
antivirus = "Windows Defender (par dÃ©faut)"
parefeu = "Actif (par dÃ©faut)"

# ===== Ã‰TAPE 4 : CRÃ‰ER LA PAGE HTML =====
html = f"""
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rapport d'Audit PC</title>
    <style>
        body {{
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            background: #f0f0f0;
            padding: 20px;
        }}
        .rapport {{
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }}
        h1 {{
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }}
        .info {{
            margin: 15px 0;
            padding: 10px;
            background: #ecf0f1;
            border-left: 4px solid #3498db;
        }}
        .label {{
            font-weight: bold;
            color: #2c3e50;
        }}
    </style>
</head>
<body>
    <div class="rapport">
        <h1>ğŸ“‹ RAPPORT D'AUDIT PC</h1>
        
        <div class="info">
            <span class="label">ğŸ‘¤ Nom :</span> {nom}
        </div>
        <div class="info">
            <span class="label">ğŸ‘¤ PrÃ©nom :</span> {prenom}
        </div>
        <div class="info">
            <span class="label">ğŸ’» Poste :</span> {poste}
        </div>
        <div class="info">
            <span class="label">ğŸ“… Date :</span> {date_audit}
        </div>
        <div class="info">
            <span class="label">ğŸ• Heure :</span> {heure_audit}
        </div>
        
        <h2>ğŸ–¥ï¸ INFORMATIONS TECHNIQUES</h2>
        
        <div class="info">
            <span class="label">ğŸ”Œ Ports USB :</span> {nb_usb}
        </div>
        <div class="info">
            <span class="label">ğŸ’¿ SystÃ¨me :</span> {systeme}
        </div>
        <div class="info">
            <span class="label">âš™ï¸ Processeur :</span> {processeur}
        </div>
        <div class="info">
            <span class="label">ğŸ—ï¸ Architecture :</span> {architecture}
        </div>
        <div class="info">
            <span class="label">ğŸ§  RAM :</span> {ram_go} Go
        </div>
        <div class="info">
            <span class="label">ğŸ’¾ Disque :</span> {disque_libre_go} Go libre / {disque_total_go} Go total
        </div>
        <div class="info">
            <span class="label">âš¡ BIOS/UEFI :</span> {bios}
        </div>
        <div class="info">
            <span class="label">ğŸŒ IP locale :</span> {ip_locale}
        </div>
        <div class="info">
            <span class="label">ğŸ”– MAC :</span> Voir paramÃ¨tres rÃ©seau
        </div>
        <div class="info">
            <span class="label">ğŸ›¡ï¸ Antivirus :</span> {antivirus}
        </div>
        <div class="info">
            <span class="label">ğŸ”¥ Pare-feu :</span> {parefeu}
        </div>
    </div>
</body>
</html>
"""

# ===== Ã‰TAPE 5 : SAUVEGARDER ET OUVRIR =====
# CrÃ©er le fichier HTML
with open("audit_pc.html", "w", encoding="utf-8") as fichier:
    fichier.write(html)

# Ouvrir dans le navigateur
webbrowser.open("audit_pc.html")

print("\nâœ… Rapport crÃ©Ã© ! Le navigateur va s'ouvrir automatiquement.")
